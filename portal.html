<script>
    // CREDENCIALES INTEGRADAS (Asegúrate de que tus credenciales estén aquí)
    const supabaseUrl = 'https://sncznbowdiarakoekxit.supabase.co'; 
    const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNuY3puYm93ZGlhcmFrb2VreGl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzNTcwMTgsImV4cCI6MjA3NTkzMzAxOH0.X7hSM3_h0kPPpbxm-y7pbtOPXpnmk41uiwrN4lnGRJU'; 
    const { createClient } = supabase;
    const supabaseClient = createClient(supabaseUrl, supabaseAnonKey);

    // Redirige si ya está logeado
    async function checkSession() {
        const { data: { session } } = await supabaseClient.auth.getSession();
        if (session) {
            // 1. Redirección si ya hay sesión activa
            window.location.href = 'panel.html'; 
        }
    }
    
    const loginForm = document.getElementById('loginForm');
    const message = document.getElementById('message');

    loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        message.textContent = 'Iniciando sesión...';
        message.style.color = 'var(--accent)';

        const { error } = await supabaseClient.auth.signInWithPassword({
            email: email,
            password: password
        });

        if (error) {
            message.textContent = `Error de acceso: ${error.message}. Verifica tus credenciales.`;
            message.style.color = 'red';
        } else {
            // 2. Redirección después de iniciar sesión exitosamente
            message.textContent = 'Acceso exitoso. Redirigiendo...';
            window.location.href = 'panel.html';
        }
    });

    document.addEventListener('DOMContentLoaded', checkSession);
</script>
